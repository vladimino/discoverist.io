{% extends "base.twig" %}

{% block content %}
    <div id="wrapper">

        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                {% for tour in tours %}
                    <li {% if tour.idtournament == currentTourId %} class="active"{% endif %}>
                        <a href="?tournament={{ tour.idtournament }}">{{ tour.name }}</a>
                        {% if tour.idtournament == currentTourId %}<span class="sr-only">(current)</span>{% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                        <h1 class="page-header">Результаты турниров ЧГК</h1>
                        <form class="form-inline">
                            <div class="form-group">
                                <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">Выберите из списка</a>
                                или
                                <label for="tourID">введите ID турнира: </label>
                                <input type="number" id="tourID" class="form-control" name="tournament"
                                       value="{{ currentTourId }}"
                                       placeholder="ID турнира">
                            </div>
                            <input type="submit" class="btn btn-default" title="Результаты по всей Герамнии"
                                   name="country"
                                   value="Германия">
                            <input type="submit" class="btn btn-primary" title="Результаты только по Берлину"
                                   name="town"
                                   value="Берлин">
                        </form>

                        <hr>

                        <h2 class="sub-header">
                            {{ currentTourInfo.name }}
                            <a class="btn btn-info"
                               href="http://rating.chgk.info/tournament/{{ currentTourInfo.idtournament }}"
                               target="_blank">
                                <span class="glyphicon glyphicon-share-alt" aria-hidden="true"></span>
                                Открыть на сайте рейтинга
                            </a>
                        </h2>
                        <div class="panel panel-info">
                            <!-- List group -->
                            <ul class="list-group">
                                <li class="list-group-item"><strong>Начало:</strong> {{ currentTourInfo.date_start }}
                                </li>
                                <li class="list-group-item"><strong>Окончание:</strong> {{ currentTourInfo.date_end }}
                                </li>
                                <li class="list-group-item"><strong>Всего
                                        вопросов:</strong> {{ currentTourInfo.questions_total }}
                                </li>
                            </ul>
                        </div>

                        <h2 class="sub-header">Таблица результатов</h2>
                        {% if results is not empty %}
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th class="text-center">Место</th>
                                    <th>Команда</th>
                                    <th>Город</th>
                                    <th>Взято</th>
                                    <th>Рейтинг</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for i,result in results %}
                                    <tr>
                                        <td class="text-center">{{ result.place }}</td>
                                        <td>{{ result.base_name }}</td>
                                        <td>{{ result.town }}</td>
                                        <td>{{ result.questions_total }}</td>
                                        <td>{{ result.bonus_b }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        {% else %}
                            <p class="bg-danger">Извините, результаты не найдены.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>
    <!-- /#wrapper -->
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $("#menu-toggle").click(function (e) {
            e.preventDefault();
            $("#wrapper").toggleClass("toggled");
        });
    </script>
{% endblock %}